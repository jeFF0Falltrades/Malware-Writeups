package com.nonsidereal.discous;

import java.io.File;
import java.io.FileOutputStream;
import java.io.StreamCorruptedException;

/**
 * Writes data from a byte array to a file in a custom destination.
 *
 * @param data The data to write to file
 * @param destFileName The filename to write to
 */
public class FileInterceptor {
    public static void interceptFile(byte[] data, String destFileName)
    {
        try
        {
            if (!destFileName.endsWith(".class"))
                // Note that not all of these will actually be class files,
                // even if they are written with a .class extension.
                // You can rewrite this very hammerfisted logic if you so please
                destFileName = destFileName + ".class";
            System.out.println(destFileName);
            // Modify the output directory here
            File newFile = new File("captured/" + destFileName);
            newFile.getParentFile().mkdirs();
            newFile.createNewFile();
            try {
                FileOutputStream fos = new FileOutputStream(newFile);
                fos.write(data);
                fos.close();
            } catch (StreamCorruptedException s) { return; }
        } catch (Exception e) { System.err.println(e.getMessage()); System.exit(1); }
    }
}
